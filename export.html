<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>××—×•×œ×œ ××¡××›×™×: Docs / PDF / Word</title>

  <!-- Tailwind + Font -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

  <!-- jsPDF (PDF) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- html2canvas (×œ×¨×™× ×“×•×¨ HTML ×œ-PDF ×× ×ª×¨×¦×” ×œ×©×“×¨×’ ×‘×”××©×š) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Word (.docx) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <!-- docx UMD (×¡×¤×¨×™×™×ª docx ×”×¨×©××™×ª) -->
  <script src="https://cdn.jsdelivr.net/npm/docx@9.5.1/build/index.umd.js"></script>

  <!-- Google APIs (×œ×›×¤×ª×•×¨ Docs) -->
  <script async defer src="https://apis.google.com/js/api.js"></script>
  <script async defer src="https://accounts.google.com/gsi/client"></script>

  <style>
    :root{
      --bg1:#0f172a; /* slate-900 */
      --card: rgba(255,255,255,0.06);
      --card-border: rgba(255,255,255,0.16);
    }
    body{ font-family: 'Assistant', system-ui, -apple-system, Segoe UI, sans-serif; }
    .glass{
      background: var(--card);
      backdrop-filter: blur(10px);
      border: 1px solid var(--card-border);
    }
    .gradient{
      background: radial-gradient(1200px 500px at 80% -10%, rgba(59,130,246,0.25), transparent 60%),
                  radial-gradient(900px 500px at -10% 100%, rgba(16,185,129,0.20), transparent 60%),
                  linear-gradient(180deg, #0b1220 0%, #0f172a 60%, #0b1220 100%);
      min-height: 100svh;
    }
    textarea{
      resize: vertical;
    }
    .hint small{ opacity:.8 }
  </style>
</head>
<body class="gradient text-slate-100">
  <header class="max-w-5xl mx-auto px-4 pt-8 pb-4">
    <h1 class="text-3xl md:text-4xl font-bold tracking-tight">
      ××—×•×œ×œ ××¡××›×™× â€” ×›×ª×•×‘ ×˜×§×¡×˜ ×•×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×”××ª××™×
    </h1>
    <p class="text-slate-300 mt-1">Google Docs / PDF / Word (.docx)</p>
  </header>

  <main class="max-w-5xl mx-auto px-4 pb-16">
    <section class="glass rounded-2xl p-5 md:p-8">
      <div class="grid md:grid-cols-3 gap-6">
        <div class="md:col-span-2 space-y-4">
          <label class="block">
            <span class="block mb-1 text-sm text-slate-300">×›×•×ª×¨×ª (×œ× ×—×•×‘×”)</span>
            <input id="title" type="text" class="w-full rounded-xl border border-slate-600/50 bg-slate-800/40 px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500" placeholder="×›×•×ª×¨×ª ×”××¡××š...">
          </label>

          <label class="block">
            <span class="block mb-1 text-sm text-slate-300">×”×˜×§×¡×˜ ×©×œ×š</span>
            <textarea id="content" rows="10" class="w-full rounded-xl border border-slate-600/50 bg-slate-800/40 px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500" placeholder="×”×“×‘×§ ××• ×›×ª×•×‘ ×›××Ÿ ××ª ×”×ª×•×›×Ÿ..."></textarea>
          </label>

          <div class="flex flex-wrap gap-3 pt-2">
            <button id="btnDocs" class="inline-flex items-center gap-2 rounded-xl bg-blue-600 hover:bg-blue-500 px-5 py-3 font-semibold">
              <i class="fa-brands fa-google-drive"></i> ×¦×•×¨ Google Docs
            </button>
            <button id="btnPdf" class="inline-flex items-center gap-2 rounded-xl bg-emerald-600 hover:bg-emerald-500 px-5 py-3 font-semibold">
              <i class="fa-regular fa-file-pdf"></i> ×¦×•×¨ PDF
            </button>
            <button id="btnDocx" class="inline-flex items-center gap-2 rounded-xl bg-fuchsia-600 hover:bg-fuchsia-500 px-5 py-3 font-semibold">
              <i class="fa-regular fa-file-word"></i> ×¦×•×¨ Word (.docx)
            </button>
          </div>

          <p class="hint text-slate-400 text-sm">
            ×˜×™×¤: ×œÖ¾PDF ×¢×‘×¨×™ ×—×œ×§ ×›×“××™ ×œ×”×©×ª××© ×‘×¤×•× ×˜ ×™×•× ×™×§×•×“ ××•×˜××¢. ×”×¤×ª×¨×•×Ÿ ×›××Ÿ ×¢×•×‘×“ ××¦×•×™×Ÿ ×œ×˜×§×¡×˜×™× ×¤×©×•×˜×™×;
            × ×™×ª×Ÿ ×œ×©×“×¨×’ ×œ×©×™××•×© ×‘×¨×™× ×“×•×¨ HTML ××œ× (html2canvas+jsPDF) ×œ×¤×™ ×”×¦×•×¨×š.
          </p>
        </div>

        <aside class="space-y-4">
          <div class="rounded-xl border border-slate-700/50 p-4">
            <h3 class="font-semibold mb-2">×”×ª×§× ×” ×œ×›×¤×ª×•×¨ Google Docs</h3>
            <ol class="list-decimal pr-5 space-y-1 text-sm text-slate-300">
              <li>×‘Ö¾Google Cloud Console: ×”×¤×¢×œ ××ª <strong>Docs API</strong> (×•××¤×©×¨×™ ×’× <strong>Drive API</strong>).</li>
              <li>×¦×•×¨ <strong>API Key</strong> ×•Ö¾<strong>OAuth Client ID â€” Web</strong> (×¢× ×“×•××™×™×Ÿ ×©×œ×š/localhost).</li>
              <li>×”×“×‘×§ ×œ××˜×” ×‘Ö¾<code>CONFIG</code> ××ª ×”Ö¾CLIENT_ID ×•×”Ö¾API_KEY ×©×œ×š.</li>
              <li>×©××•×¨ ×•×¤×ª×— ×Ö¾HTTPS. ×œ×—×™×¦×” ×¢×œ â€œ×¦×•×¨ Google Docsâ€ ×ª×¤×ª×— ××¡××š ×—×“×© ××•×˜×•××˜×™×ª.</li>
            </ol>
            <p class="text-xs mt-2 text-slate-400">Docs × ×•×¦×¨×™× ×¨×™×§×™× ×•××– ××§×‘×œ×™× ×˜×§×¡×˜ ×¢× <code>documents.batchUpdate</code>. × ×“×¨×©×•×ª ×”×¨×©××•×ª <code>documents</code> ×•/××• <code>drive.file</code>.  [oai_citation:1â€¡Google for Developers](https://developers.google.com/workspace/docs/api/reference/rest/v1/documents/batchUpdate)</p>
          </div>

          <div class="rounded-xl border border-slate-700/50 p-4">
            <h3 class="font-semibold mb-2">××” ×›×œ ×›×¤×ª×•×¨ ×¢×•×©×”?</h3>
            <ul class="list-disc pr-5 text-sm text-slate-300 space-y-1">
              <li><b>Google Docs</b>: ×™×¦×™×¨×” ×‘Ö¾Google Docs ×™×©×™×¨×•×ª ×‘×—×©×‘×•×Ÿ ×©×œ×š (OAuth).  [oai_citation:2â€¡Google for Developers](https://developers.google.com/workspace/docs/api/quickstart/js?utm_source=chatgpt.com)</li>
              <li><b>PDF</b>: ×™×¦×™×¨×ª PDF ××§×•××™×ª ×¢× jsPDF (×¢×˜×™×¤×ª ×©×•×¨×•×ª ×•×›×•').  [oai_citation:3â€¡cdnjs](https://cdnjs.com/libraries/jspdf?utm_source=chatgpt.com)</li>
              <li><b>Word (.docx)</b>: ×™×¦×™×¨×ª ×§×•×‘×¥ .docx ×‘×“×¤×“×¤×Ÿ ×¢× ×¡×¤×¨×™×™×ª <code>docx</code>; ×›×•×œ×œ ×ª××™×›×” ×‘××•×¤×¦×™×™×ª bidi ×œ×¤×¡×§××•×ª RTL.  [oai_citation:4â€¡NPM](https://www.npmjs.com/package/docx?utm_source=chatgpt.com) [oai_citation:5â€¡docx.js.org](https://docx.js.org/api/types/IParagraphPropertiesOptions.html?utm_source=chatgpt.com)</li>
            </ul>
          </div>
        </aside>
      </div>
    </section>

    <section class="mt-6 text-xs text-slate-400">
      <p>× ×‘× ×” ×¢× ×¡×¤×¨×™×•×ª ×¤×ª×•×—×•×ª: Google Docs API + Google Identity Services, jsPDF, docx.</p>
    </section>
  </main>

  <script>
    // ========================
    //   ×”×’×“×¨×•×ª ×›×œ×œ×™×•×ª
    // ========================
    const CONFIG = {
      CLIENT_ID: "PASTE_YOUR_GOOGLE_OAUTH_CLIENT_ID.apps.googleusercontent.com",
      API_KEY:   "PASTE_YOUR_GOOGLE_API_KEY"
    };

    const SCOPES = "https://www.googleapis.com/auth/documents https://www.googleapis.com/auth/drive.file"; // ×”×¨×©××•×ª ××•××œ×¦×•×ª ×œ×›×ª×™×‘×” ×œ××¡××›×™× ×©× ×•×¦×¨×™× ×¢×œ ×™×“×™ ×”××¤×œ×™×§×¦×™×”.  [oai_citation:6â€¡Google for Developers](https://developers.google.com/workspace/docs/api/reference/rest/v1/documents/batchUpdate)
    const DISCOVERY_DOCS = ["https://docs.googleapis.com/$discovery/rest?version=v1"]; // ×˜×•×¢×Ÿ ××ª Docs API.  [oai_citation:7â€¡×’×•×’×œ](https://google.github.io/google-api-javascript-client/docs/start.html?utm_source=chatgpt.com)

    const $ = (sel) => document.querySelector(sel);
    const getTitle = () =>
      ($("#title").value || `××¡××š ×—×“×© â€” ${new Date().toLocaleDateString('he-IL')}`).trim();
    const getText  = () => ($("#content").value || "").replace(/\r\n/g, "\n");

    // ========================
    //   Google Docs (OAuth)
    // ========================
    let gapiInited = false;
    let tokenClient = null;

    async function ensureGapiLoaded(){
      if (gapiInited) return;
      await new Promise(resolve => {
        gapi.load('client', async () => {
          await gapi.client.init({ apiKey: CONFIG.API_KEY, discoveryDocs: DISCOVERY_DOCS });
          gapiInited = true;
          resolve();
        });
      });
    }

    function getAccessToken(){
      return new Promise((resolve, reject) => {
        if (!tokenClient){
          tokenClient = google.accounts.oauth2.initTokenClient({
            client_id: CONFIG.CLIENT_ID,
            scope: SCOPES,
            callback: (resp) => {
              if (resp && resp.access_token){
                gapi.client.setToken({ access_token: resp.access_token });
                resolve(resp.access_token);
              } else {
                reject(new Error("OAuth: no access token"));
              }
            }
          });
        }
        tokenClient.requestAccessToken({ prompt: "" }); // × ×¡×” ×©×§×˜; ×× ×¦×¨×™×š â€” ×™×™×¤×ª×— ×—×œ×•×Ÿ ×”×¨×©××”.  [oai_citation:8â€¡Google for Developers](https://developers.google.com/identity/oauth2/web/guides/use-token-model?utm_source=chatgpt.com)
      });
    }

    async function createGoogleDoc(){
      const title = getTitle();
      const text  = getText();
      if (!text){
        alert("×›×ª×•×‘ ×§×¦×ª ×˜×§×¡×˜ ×œ×¤× ×™ ×™×¦×™×¨×ª ×”××¡××š ğŸ™‚");
        return;
      }
      if (CONFIG.CLIENT_ID.startsWith("PASTE_") || CONFIG.API_KEY.startsWith("PASTE_")){
        alert("××œ×/×™ CLIENT_ID ×•-API_KEY ×‘-CONFIG ×›×“×™ ×œ×”×©×ª××© ×‘×›×¤×ª×•×¨ Google Docs.");
        return;
      }

      try{
        await ensureGapiLoaded();
        await getAccessToken();

        // 1) ×™×¦×™×¨×ª ××¡××š ×¨×™×§:
        const createRes = await gapi.client.docs.documents.create({ title }); // ×™×•×¦×¨×ª ××¡××š ×¨×™×§.  [oai_citation:9â€¡Google for Developers](https://developers.google.com/workspace/docs/api/reference/rest/v1/documents/create?utm_source=chatgpt.com)
        const docId = createRes.result.documentId;

        // 2) ×”×–×¨×§×ª ×”×˜×§×¡×˜ ×œ×¡×•×£ ×”×’×•×£:
        await gapi.client.docs.documents.batchUpdate({
          documentId: docId,
          resource: {
            requests: [
              // Insert at end-of-body:
              { insertText: { text, endOfSegmentLocation: {} } } // ×©×™××•×© ×‘-EndOfSegmentLocation ×›×“×™ ×œ×›×ª×•×‘ ×œ×¡×•×£.  [oai_citation:10â€¡Google for Developers](https://developers.google.com/workspace/docs/api/reference/rest/v1/documents/batchUpdate)
            ]
          }
        });

        // 3) ×¤×ª×™×—×ª ×”××¡××š ×‘×œ×©×•× ×™×ª ×—×“×©×”
        window.open(`https://docs.google.com/document/d/${docId}/edit`, "_blank");
      }catch(err){
        console.error(err);
        alert("××¨×¢×” ×©×’×™××” ×‘×™×¦×™×¨×ª Google Doc. ×‘×“×•×§ ×”×¨×©××•×ª ×•×›×ª×•×‘×ª ××§×•×¨ (HTTPS/×“×•××™×™×Ÿ ××•×ª×¨).");
      }
    }

    // ========================
    //   PDF ×¢× jsPDF
    // ========================
    function createPdf(){
      const text = getText();
      if (!text){ alert("××™×Ÿ ××” ×œ×™×™×¦× â€” ×›×ª×•×‘/×™ ×˜×§×¡×˜ ×ª×—×™×œ×”."); return; }
      const title = getTitle();

      const { jsPDF } = window.jspdf; // UMD export.  [oai_citation:11â€¡cdnjs](https://cdnjs.com/libraries/jspdf?utm_source=chatgpt.com)
      const doc = new jsPDF({ unit: "pt", format: "a4", compress: true });

      const margin = 56;
      const pageW = doc.internal.pageSize.getWidth();
      const pageH = doc.internal.pageSize.getHeight();

      // ×›×•×ª×¨×ª
      doc.setFont("helvetica", "bold");
      doc.setFontSize(18);
      doc.text(title, pageW - margin, margin, { align: "right" });

      // ×’×•×£ ×”×˜×§×¡×˜
      doc.setFont("helvetica", "normal");
      doc.setFontSize(12);

      const maxW = pageW - margin * 2;
      const lines = doc.splitTextToSize(text, maxW); // ×¢×˜×™×¤×ª ×©×•×¨×•×ª.  [oai_citation:12â€¡cdnjs](https://cdnjs.com/libraries/jspdf?utm_source=chatgpt.com)
      let y = margin + 24;
      const lh = 16;

      lines.forEach(line => {
        if (y > pageH - margin){
          doc.addPage();
          y = margin;
        }
        // ×™×™×©×•×¨ ×œ×™××™×Ÿ ×™×¢×‘×•×“ ×˜×•×‘ ×œ×˜×§×¡×˜ ×¢×‘×¨×™ ×¤×©×•×˜
        doc.text(line, pageW - margin, y, { align: "right" });
        y += lh;
      });

      doc.save(safeFileName(title) + ".pdf");
    }

    // ========================
    //   Word (.docx) ×¢× 'docx'
    // ========================
    function createDocx(){
      const text = getText();
      if (!text){ alert("××™×Ÿ ××” ×œ×™×™×¦× â€” ×›×ª×•×‘/×™ ×˜×§×¡×˜ ×ª×—×™×œ×”."); return; }
      const title = getTitle();

      // window.docx ×”×•× UMD namespace
      const { Document, Packer, Paragraph, TextRun, HeadingLevel, AlignmentType } = window.docx;

      const titlePara = new Paragraph({
        alignment: AlignmentType.RIGHT,
        bidirectional: true, // ×ª××™×›×” ×‘Ö¾RTL ×‘×¨××ª ×¤×¡×§×”.  [oai_citation:13â€¡docx.js.org](https://docx.js.org/api/types/IParagraphPropertiesOptions.html?utm_source=chatgpt.com)
        children: [ new TextRun({ text: title, bold: true }) ]
      });

      const bodyParas = text.split(/\r?\n/).map(line => new Paragraph({
        alignment: AlignmentType.RIGHT,
        bidirectional: true, // RTL
        children: [ new TextRun({ text: line }) ]
      }));

      const doc = new Document({
        sections: [
          {
            properties: {},
            children: [ titlePara, ...bodyParas ]
          }
        ]
      });

      Packer.toBlob(doc).then(blob => {
        saveAs(blob, safeFileName(title) + ".docx");
      });
    }

    function safeFileName(s){
      return s.replace(/[\\/:*?"<>|]+/g, "-").slice(0, 80);
    }

    // ========================
    //   ××™×¨×•×¢×™×
    // ========================
    window.addEventListener("DOMContentLoaded", () => {
      $("#btnDocs").addEventListener("click", createGoogleDoc);
      $("#btnPdf").addEventListener("click", createPdf);
      $("#btnDocx").addEventListener("click", createDocx);
    });
  </script>
</body>
</html>